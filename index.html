<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Semester Grade Calculator</title>
  <style>
    /* (your existing styles, unchanged) */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(120deg, #2563eb 0%, #7c3aed 100%);
      min-height: 100vh;
      padding: 30px 20px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .container {
      background: white;
      border-radius: 16px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
      max-width: 650px;
      width: 100%;
      padding: 35px;
    }
    /* (other CSS stays the same) */
  </style>
</head>
<body>
  <div class="container">
    <h1>ðŸŽ“ Semester Calculator</h1>
    <p class="subtitle">Enter your scores (0-20)</p>
    
    <div id="subjects-container"></div>
    
    <button onclick="calculateAverage()">Calculate Average</button>
    <button style="margin-top:10px; background:#ef4444;" onclick="resetGrades()">Reset All</button> <!-- NEW -->

    <div class="final-result" id="final-result">
      <h2>Your Semester Average</h2>
      <div class="average" id="average-number">0.00</div>
      <div class="status" id="status-message"></div>
    </div>
  </div>

  <script>
    const subjects = [
      { name: "Embedded Systems", coefficient: 3, evaluation: "both" },
      { name: "Digital Signal Processors", coefficient: 3, evaluation: "both" },
      { name: "HPC", coefficient: 3, evaluation: "both" },
      { name: "Computer Networks", coefficient: 2, evaluation: "both" },
      { name: "Embedded Systems Lab", coefficient: 1, evaluation: "continuous" },
      { name: "Digital Signal Processors Lab", coefficient: 1, evaluation: "continuous" },
      { name: "HPC Lab", coefficient: 1, evaluation: "continuous" },
      { name: "Computer Networks Lab", coefficient: 1, evaluation: "continuous" },
      { name: "Project Management", coefficient: 1, evaluation: "exam" },
      { name: "Communication Skills", coefficient: 1, evaluation: "exam" },
    ];

    const container = document.getElementById('subjects-container');

    // Load saved grades if exist
    const savedGrades = JSON.parse(localStorage.getItem('grades')) || {}; // NEW

    subjects.forEach((subject, index) => {
      const div = document.createElement('div');
      div.className = 'subject';
      
      let inputsHTML = '';
      if (subject.evaluation === 'both') {
        inputsHTML = `
          <div class="inputs">
            <div class="input-field">
              <label>Test (40%)</label>
              <input type="number" id="test-${index}" min="0" max="20" step="0.5" placeholder="0-20">
            </div>
            <div class="input-field">
              <label>Exam (60%)</label>
              <input type="number" id="exam-${index}" min="0" max="20" step="0.5" placeholder="0-20">
            </div>
          </div>
        `;
      } else if (subject.evaluation === 'continuous') {
        inputsHTML = `
          <div class="inputs">
            <div class="input-field">
              <label>Continuous Assessment</label>
              <input type="number" id="continuous-${index}" min="0" max="20" step="0.5" placeholder="0-20">
            </div>
          </div>
        `;
      } else if (subject.evaluation === 'exam') {
        inputsHTML = `
          <div class="inputs">
            <div class="input-field">
              <label>Exam Score</label>
              <input type="number" id="exam-${index}" min="0" max="20" step="0.5" placeholder="0-20">
            </div>
          </div>
        `;
      }
      
      div.innerHTML = `
        <div class="subject-header">
          <div class="subject-name">${subject.name}</div>
          <div class="coef-badge">Coef ${subject.coefficient}</div>
        </div>
        ${inputsHTML}
        <div class="result" id="result-${index}"></div>
      `;
      container.appendChild(div);
    });

    // Restore saved values from localStorage
    window.addEventListener('load', () => { // NEW
      subjects.forEach((subject, index) => {
        const { evaluation } = subject;
        if (evaluation === 'both') {
          if (savedGrades[`test-${index}`]) document.getElementById(`test-${index}`).value = savedGrades[`test-${index}`];
          if (savedGrades[`exam-${index}`]) document.getElementById(`exam-${index}`).value = savedGrades[`exam-${index}`];
        } else if (evaluation === 'continuous') {
          if (savedGrades[`continuous-${index}`]) document.getElementById(`continuous-${index}`).value = savedGrades[`continuous-${index}`];
        } else if (evaluation === 'exam') {
          if (savedGrades[`exam-${index}`]) document.getElementById(`exam-${index}`).value = savedGrades[`exam-${index}`];
        }
      });
    });

    // Save grades whenever user types
    container.addEventListener('input', (e) => { // NEW
      if (e.target.tagName === 'INPUT') {
        savedGrades[e.target.id] = e.target.value;
        localStorage.setItem('grades', JSON.stringify(savedGrades));
      }
    });

    function calculateAverage() {
      let totalWeightedScore = 0;
      let totalCoefficient = 0;
      let isValid = true;

      subjects.forEach((subject, index) => {
        const { coefficient, evaluation } = subject;
        let grade = 0;

        if (evaluation === 'both') {
          const test = parseFloat(document.getElementById(`test-${index}`).value);
          const exam = parseFloat(document.getElementById(`exam-${index}`).value);

          if (isNaN(test) || isNaN(exam) || test < 0 || test > 20 || exam < 0 || exam > 20) {
            isValid = false;
            return;
          }
          grade = (test * 0.4) + (exam * 0.6);
        } else if (evaluation === 'continuous') {
          const continuous = parseFloat(document.getElementById(`continuous-${index}`).value);
          if (isNaN(continuous) || continuous < 0 || continuous > 20) {
            isValid = false;
            return;
          }
          grade = continuous;
        } else if (evaluation === 'exam') {
          const exam = parseFloat(document.getElementById(`exam-${index}`).value);
          if (isNaN(exam) || exam < 0 || exam > 20) {
            isValid = false;
            return;
          }
          grade = exam;
        }

        totalWeightedScore += grade * coefficient;
        totalCoefficient += coefficient;

        const resultDiv = document.getElementById(`result-${index}`);
        resultDiv.style.display = 'block';
        resultDiv.textContent = `Subject Average: ${grade.toFixed(2)}/20`;
      });

      if (!isValid) {
        alert('âš ï¸ Please fill all fields with valid scores between 0 and 20!');
        return;
      }

      const average = totalWeightedScore / totalCoefficient;
      
      const finalResult = document.getElementById('final-result');
      const averageNumber = document.getElementById('average-number');
      const statusMessage = document.getElementById('status-message');
      
      averageNumber.textContent = average.toFixed(2) + '/20';
      
      finalResult.className = 'final-result';
      
      if (average >= 16) {
        finalResult.classList.add('excellent');
        statusMessage.textContent = 'ðŸŒŸ Outstanding Performance!';
      } else if (average >= 14) {
        finalResult.classList.add('very-good');
        statusMessage.textContent = 'ðŸŽ‰ Very Good!';
      } else if (average >= 12) {
        finalResult.classList.add('good');
        statusMessage.textContent = 'ðŸ‘ Good Work!';
      } else if (average >= 10) {
        finalResult.classList.add('pass');
        statusMessage.textContent = 'âœ… Pass!';
      } else {
        finalResult.classList.add('fail');
        statusMessage.textContent = 'ðŸ’ª Keep Improving!';
      }
      
      finalResult.style.display = 'block';
      finalResult.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    // Reset everything
    function resetGrades() { // NEW
      if (confirm('Are you sure you want to clear all grades?')) {
        localStorage.removeItem('grades');
        document.querySelectorAll('input').forEach(input => input.value = '');
        document.querySelectorAll('.result').forEach(r => r.style.display = 'none');
        document.getElementById('final-result').style.display = 'none';
      }
    }
  </script>
</body>
</html>